# This provides us with GCC binary support so we can run bash
language: generic

sudo: required

script:
  - ./build.sh
  - 'if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then bash ./scripts/aptRepoUpdater.sh; fi'

before_deploy:
  - export image_name="`echo *.iso`"
  - cat *.iso > "/home/travis/${image_name}"

notifications:
  slack: fossasia:3pMkQrSogvEMfnu9aJDW2ZYC

deploy:
  - provider: releases
    skip_cleanup: true
    api_key:
      secure: "ILvV+ORxHcfTCBXFx7y3UZRN8Sa6ftNjfeeHwI+MMxX0MuaA4pFxxvgZc8oaxRJNFB6CwIgoAEteTVPZ/yxkPjsDleNruqfOGmLtX4ClDHEWaoiaVS9fPL0cn8glmam+H2He+a+44fOf1pXK29uvmE6P+7C8VluD3f2Q5k0yF8OTGnkQgDJjBRuwxB0n1EHRbeU4WqvNM8RjdOMP7H8kQ0Fbp3IY7fai3YO/TtYfZFYfBS4njcLnlBkWB6WzNI+NTNQNccPVBXmtYx/v5jzUPIi6FUXN8UYpNj5IKyEd7HKahlhHMKGefOC3iQRF9khvlGgxmuyDz/O2YBxtaxsDjO0AnYtBq49orZgy6NkuNWV3pYseCTcUl+gc9406FuKGsoYY4t3PotSTN2XrjKEupC4BER774l8hCS0qvq6HVUuFmusnNzRFpArdePaKJUh6sg2d1vAkNdpOBPrVyUhHz/dMQvkImsbT5GNZ/IDm79XpX9AfgXkWrz25hsFzbOA2vud/VIVTARi0WFnrE4f4310gASG5bRjY/iaxQiTPf9hXNZdIq2LH+XpeL2sUMj5hJWFHTOEyuBeSZCHtTVWlyiPWX70TLkGZJjxSWlY/Yezg60AStVmXxQGJTHK8F97wULkW4YJebl9wSEao3x4AHKkupyg2p2EQd+ZGEiSopZY="
    file_glob: true # http://stackoverflow.com/a/28579635/1320237
    file: "/home/travis/${image_name}"
    on:
      branch: master
